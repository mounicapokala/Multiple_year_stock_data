Attribute VB_Name = "Module1"
Sub stock()    Dim ticker1 As String    Dim ticker2 As String    Dim Worksheet_Count As Integer        Worksheet_Count = ActiveWorkbook.Worksheets.Count       'Loop through each worksheet    For t = 1 To Worksheet_Count                volume = 0        j = 1        'Header for results        ActiveWorkbook.Worksheets(t).Cells(j, 10) = "Ticker"        ActiveWorkbook.Worksheets(t).Cells(j, 11) = "Total Stock Volume"        'Fetch last row number        LastRow = ActiveWorkbook.Worksheets(t).Cells(Rows.Count, 1).End(xlUp).Row       'Loop from Row 2 to Last row        For i = 2 To LastRow            ticker1 = ActiveWorkbook.Worksheets(t).Cells(i, 1).Value            ticker2 = ActiveWorkbook.Worksheets(t).Cells(i + 1, 1).Value                'Compare the Ticker values for consecutive rows            If ticker1 = ticker2 Then                    volume = volume + ActiveWorkbook.Worksheets(t).Cells(i, 7).Value            Else                    volume = volume + ActiveWorkbook.Worksheets(t).Cells(i, 7).Value                       'Print results in columns 10 and 11                    j = j + 1                    ActiveWorkbook.Worksheets(t).Cells(j, 10) = ticker1                    ActiveWorkbook.Worksheets(t).Cells(j, 11) = volume                        'Reset Volume to 0 for new Ticker value                    volume = 0            End If          Next i             Next t     End Sub